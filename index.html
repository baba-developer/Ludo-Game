<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Frutix Blast Pro</title>
    <style>
        body { 
            margin: 0; background: #764ba2; height: 100vh; 
            display: flex; flex-direction: column; align-items: center; 
            justify-content: center; font-family: 'Arial', sans-serif; overflow: hidden; 
        }

        /* Loading Screen */
        #splash {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #2c3e50; color: white; display: flex; flex-direction: column;
            align-items: center; justify-content: center; z-index: 10000;
        }

        /* Menu */
        #menu {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); display: none; flex-direction: column;
            align-items: center; justify-content: center; z-index: 5000;
        }

        /* Game UI */
        #game-ui { display: none; text-align: center; color: white; }
        .stats-bar { 
            display: flex; gap: 20px; background: rgba(255,255,255,0.2); 
            padding: 10px 20px; border-radius: 20px; margin-bottom: 10px;
        }
        #grid { 
            display: grid; grid-template-columns: repeat(8, 42px); 
            gap: 5px; background: rgba(255,255,255,0.1); padding: 10px; 
            border-radius: 10px; border: 3px solid white;
        }
        .candy { 
            width: 42px; height: 42px; border-radius: 8px; 
            display: flex; align-items: center; justify-content: center; 
            font-size: 24px; background: white; transition: 0.2s;
        }
        .ice { border: 3px solid #00d2ff; box-shadow: inset 0 0 10px #00d2ff; } /* Blocker Idea */

        .btn {
            padding: 15px 40px; margin: 10px; border: none; border-radius: 30px;
            background: #ff3f81; color: white; font-weight: bold; font-size: 18px;
        }
    </style>
</head>
<body>

    <div id="splash">
        <h1>Frutix Blast</h1>
        <div style="border: 4px solid #fff; border-top: 4px solid transparent; width: 40px; height: 40px; border-radius: 50%; animation: spin 1s linear infinite;"></div>
        <p>POWERED BY BABA-DEVELOPER</p>
    </div>

    <div id="menu">
        <h1 style="color: white;">FRUTIX MENU</h1>
        <button class="btn" onclick="startLevel(1)">LEVEL 1</button>
        <button class="btn" onclick="startLevel(2)">LEVEL 2</button>
        <button class="btn" onclick="alert('Settings: Sound On')">SETTINGS</button>
    </div>

    <div id="game-ui">
        <div class="stats-bar">
            <div>TARGET: <span id="target">300</span></div>
            <div>SCORE: <span id="score">0</span></div>
            <div style="color: #ffeb3b;">MOVES: <span id="moves">20</span></div>
        </div>
        <div id="grid"></div>
        <button class="btn" style="margin-top:20px; padding:10px;" onclick="location.reload()">BACK</button>
    </div>

    <script>
        const splash = document.getElementById('splash');
        const menu = document.getElementById('menu');
        const gameUI = document.getElementById('game-ui');
        const grid = document.getElementById('grid');
        
        let score = 0;
        let moves = 20;
        let target = 300;
        const width = 8;
        const candies = [];
        const candyTypes = [
            { e: 'ðŸŽ', c: '#ffadad' }, { e: 'ðŸ‡', c: '#caffbf' },
            { e: 'ðŸŠ', c: '#ffd6a5' }, { e: 'ðŸ«', c: '#a0c4ff' },
            { e: 'ðŸ‹', c: '#fdffb6' }
        ];

        // 1. Loading Splash
        setTimeout(() => {
            splash.style.display = 'none';
            menu.style.display = 'flex';
        }, 3000);

        function startLevel(lvl) {
            menu.style.display = 'none';
            gameUI.style.display = 'block';
            score = 0;
            if(lvl === 1) { moves = 20; target = 300; }
            if(lvl === 2) { moves = 15; target = 500; } // Level 2 mushkil
            document.getElementById('score').innerText = score;
            document.getElementById('moves').innerText = moves;
            document.getElementById('target').innerText = target;
            createBoard();
        }

        function createBoard() {
            grid.innerHTML = '';
            candies.length = 0;
            for (let i = 0; i < width * width; i++) {
                const candy = document.createElement('div');
                candy.classList.add('candy');
                candy.setAttribute('id', i);
                // Level 2 mein Ice blockers add karne ka logic
                if(i > 24 && i < 32 && target === 500) candy.classList.add('ice'); 
                
                let randomType = candyTypes[Math.floor(Math.random() * candyTypes.length)];
                candy.innerHTML = randomType.e;
                candy.style.backgroundColor = randomType.c;
                grid.appendChild(candy);
                candies.push(candy);
            }
            setupDrag();
        }

        function setupDrag() {
            let idD, idR;
            candies.forEach(c => {
                c.onpointerdown = (e) => idD = parseInt(e.target.id);
                c.onpointerup = (e) => {
                    const t = document.elementFromPoint(e.clientX, e.clientY);
                    if (t && t.classList.contains('candy') && !t.classList.contains('ice')) {
                        idR = parseInt(t.id);
                        handleSwap(idD, idR);
                    }
                };
            });
        }

        function handleSwap(i1, i2) {
            let adj = [i1-1, i1+1, i1-width, i1+width];
            if (adj.includes(i2) && moves > 0) {
                swap(i1, i2);
                moves--;
                document.getElementById('moves').innerText = moves;
                checkWinLoss();
            }
        }

        function swap(i1, i2) {
            let tE = candies[i1].innerHTML, tC = candies[i1].style.backgroundColor;
            candies[i1].innerHTML = candies[i2].innerHTML;
            candies[i1].style.backgroundColor = candies[i2].style.backgroundColor;
            candies[i2].innerHTML = tE;
            candies[i2].style.backgroundColor = tC;
        }

        function checkWinLoss() {
            if (score >= target) {
                alert("LEVEL CLEARED! ðŸŽ‰");
                location.reload();
            } else if (moves <= 0) {
                alert("GAME OVER! Out of moves.");
                location.reload();
            }
        }

        // Matching & Gravity Logic
        setInterval(() => {
            if(gameUI.style.display === 'block') {
                // Horizontal
                for(let i=0; i<62; i++) {
                    if(i%8 > 5) continue;
                    let r = [i, i+1, i+2];
                    let match = candies[i].innerHTML;
                    if(match && r.every(idx => candies[idx].innerHTML === match)) {
                        score += 10;
                        document.getElementById('score').innerText = score;
                        r.forEach(idx => candies[idx].innerHTML = '');
                    }
                }
                // Gravity
                for(let i=0; i<56; i++) {
                    if(candies[i+width].innerHTML === '') {
                        candies[i+width].innerHTML = candies[i].innerHTML;
                        candies[i+width].style.backgroundColor = candies[i].style.backgroundColor;
                        candies[i].innerHTML = '';
                    }
                }
                // New Candies
                for(let i=0; i<8; i++) {
                    if(candies[i].innerHTML === '') {
                        let rt = candyTypes[Math.floor(Math.random()*candyTypes.length)];
                        candies[i].innerHTML = rt.e;
                        candies[i].style.backgroundColor = rt.c;
                    }
                }
            }
        }, 200);

    </script>
    <style>@keyframes spin { 100% { transform: rotate(360deg); } }</style>
</body>
</html>
