<!DOCTYPE html>
<html>
<head>
    <title>Pro Racing Game - Speed Boost</title>
    <style>
        body { margin: 0; overflow: hidden; background: #1a1a1a; font-family: 'Segoe UI', sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; }
        #game-container { position: relative; border: 5px solid #444; border-radius: 10px; overflow: hidden; box-shadow: 0 0 30px rgba(0,0,0,0.7); }
        canvas { background: #2c3e50; display: block; }
        
        #top-ui { position: absolute; top: 0; left: 0; width: 100%; padding: 10px; display: flex; justify-content: space-between; align-items: center; background: rgba(0,0,0,0.7); box-sizing: border-box; z-index: 10; }
        .stats { color: white; font-size: 16px; font-weight: bold; }
        .btn-group { display: flex; gap: 8px; }
        
        button { padding: 8px 15px; font-size: 12px; cursor: pointer; border: none; border-radius: 4px; background: #e74c3c; color: white; font-weight: bold; text-transform: uppercase; }
        button:hover { background: #ff5e4d; }
        #pauseBtn { background: #f1c40f; color: #000; }
        
        #shield-timer { position: absolute; top: 60px; width: 100%; text-align: center; color: #ff3f81; font-weight: bold; font-size: 20px; display: none; text-shadow: 0 0 10px #ff3f81; z-index: 5; }
        #speed-alert { position: absolute; bottom: 20px; width: 100%; text-align: center; color: #2ecc71; font-weight: bold; font-size: 14px; opacity: 0; transition: 0.5s; }
    </style>
</head>
<body>

    <div id="game-container">
        <div id="top-ui">
            <div class="stats">Score: <span id="scoreVal">0</span> | High: <span id="highScore">0</span></div>
            <div class="btn-group">
                <button id="pauseBtn" onclick="togglePause()">PAUSE</button>
                <button onclick="resetGame()">RESTART</button>
            </div>
        </div>
        
        <div id="shield-timer">SHIELD ACTIVE: <span id="timer">5</span>s</div>
        <div id="speed-alert">LEVEL UP: SPEED INCREASED! ⚡</div>
        <canvas id="gameCanvas"></canvas>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const scoreElement = document.getElementById('scoreVal');
        const highscoreElement = document.getElementById('highScore');
        const shieldUI = document.getElementById('shield-timer');
        const timerVal = document.getElementById('timer');
        const speedAlert = document.getElementById('speed-alert');

        canvas.width = 400;
        canvas.height = 600;

        let score = 0;
        let highScore = localStorage.getItem('racingHighScore') || 0;
        highscoreElement.innerText = highScore;

        let gameActive = true;
        let isPaused = false;
        let isShielded = false;
        let shieldTimeLeft = 0;
        let difficultyMultiplier = 1; // Speed barhane ke liye

        let car = { x: 175, y: 480, w: 45, h: 85, speed: 7 };
        let enemies = [];
        let hearts = [];
        const lanes = [40, 130, 220, 310];

        let keys = {};
        window.addEventListener('keydown', e => keys[e.code] = true);
        window.addEventListener('keyup', e => keys[e.code] = false);

        function drawCar(x, y, color, isPlayer) {
            if (isPlayer && isShielded) {
                ctx.shadowBlur = 20;
                ctx.shadowColor = "#ff3f81";
                ctx.strokeStyle = "#ff3f81";
                ctx.lineWidth = 3;
                ctx.strokeRect(x-5, y-5, 55, 95);
            }

            ctx.fillStyle = "#000"; // Wheels
            ctx.fillRect(x-2, y+10, 5, 15); ctx.fillRect(x+42, y+10, 5, 15);
            ctx.fillRect(x-2, y+60, 5, 15); ctx.fillRect(x+42, y+60, 5, 15);
            
            ctx.fillStyle = color; // Body
            ctx.beginPath(); ctx.roundRect(x, y, 45, 85, 8); ctx.fill();
            
            ctx.fillStyle = "rgba(255,255,255,0.4)"; // Window
            isPlayer ? ctx.fillRect(x+5, y+15, 35, 12) : ctx.fillRect(x+5, y+58, 35, 12);
            ctx.shadowBlur = 0;
        }

        function drawHeart(x, y) {
            ctx.font = "30px Arial";
            ctx.fillText("❤️", x, y);
        }

        function spawnObjects() {
            // Jaise score barhega, spawn rate bhi barhega
            let spawnChance = 0.02 + (score > 20 ? (score - 20) * 0.001 : 0);
            
            if (Math.random() < spawnChance && enemies.length < 4) {
                let lane = lanes[Math.floor(Math.random() * lanes.length)];
                if (!enemies.some(e => e.y < 200 && e.x === lane)) {
                    // Score 20 ke baad speed barhna shuru hogi
                    let baseSpeed = 4 + (score > 20 ? (score - 20) * 0.2 : 0);
                    enemies.push({ x: lane, y: -100, w: 45, h: 85, speed: baseSpeed + Math.random() * 2 });
                }
            }

            if (Math.random() < 0.003 && hearts.length < 1 && !isShielded) {
                hearts.push({ x: lanes[Math.floor(Math.random()*lanes.length)] + 10, y: -50, w: 30, h: 30 });
            }
        }

        function activateShield() {
            isShielded = true;
            shieldTimeLeft = 5;
            shieldUI.style.display = "block";
            let timerInterval = setInterval(() => {
                if (isPaused) return;
                shieldTimeLeft--;
                timerVal.innerText = shieldTimeLeft;
                if (shieldTimeLeft <= 0) {
                    clearInterval(timerInterval);
                    isShielded = false;
                    shieldUI.style.display = "none";
                }
            }, 1000);
        }

        function togglePause() {
            isPaused = !isPaused;
            document.getElementById('pauseBtn').innerText = isPaused ? "RESUME" : "PAUSE";
            if(!isPaused) animate();
        }

        function resetGame() {
            score = 0; scoreElement.innerText = score;
            enemies = []; hearts = [];
            isShielded = false; shieldUI.style.display = "none";
            speedAlert.style.opacity = 0;
            car.x = 175; gameActive = true; isPaused = false;
        }

        function update() {
            if (!gameActive || isPaused) return;

            if (keys['ArrowLeft'] && car.x > 10) car.x -= car.speed;
            if (keys['ArrowRight'] && car.x < canvas.width - car.w - 10) car.x += car.speed;

            // Speed Increase Alert
            if (score === 21) {
                speedAlert.style.opacity = 1;
                setTimeout(() => speedAlert.style.opacity = 0, 3000);
            }

            // Enemies Update
            enemies.forEach((enemy, index) => {
                enemy.y += enemy.speed;
                if (car.x < enemy.x + enemy.w && car.x + car.w > enemy.x &&
                    car.y < enemy.y + enemy.h && car.y + car.h > enemy.y) {
                    if (!isShielded) {
                        gameActive = false;
                        if(score > highScore) {
                            highScore = score;
                            localStorage.setItem('racingHighScore', score);
                            highscoreElement.innerText = highScore;
                        }
                        alert("BOOM! Game Over. Score: " + score);
                        resetGame();
                    }
                }
                if (enemy.y > canvas.height) { 
                    enemies.splice(index, 1); 
                    score++; 
                    scoreElement.innerText = score; 
                }
            });

            // Hearts Update
            hearts.forEach((h, index) => {
                h.y += 4;
                if (car.x < h.x + h.w && car.x + car.w > h.x && car.y < h.y + h.h && car.y + car.h > h.y) {
                    hearts.splice(index, 1);
                    activateShield();
                }
                if (h.y > canvas.height) hearts.splice(index, 1);
            });

            spawnObjects();
        }

        function draw() {
            ctx.fillStyle = "#2c3e50"; ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Road Lines Animation
            ctx.strokeStyle = "rgba(255,255,255,0.6)"; 
            ctx.setLineDash([30, 30]);
            ctx.lineDashOffset -= (5 + (score > 20 ? (score-20)*0.1 : 0)); 
            
            for(let i=1; i<4; i++) {
                ctx.beginPath(); ctx.moveTo(i * 100, 0); ctx.lineTo(i * 100, canvas.height); ctx.stroke();
            }

            drawCar(car.x, car.y, "#00d2ff", true);
            enemies.forEach(e => drawCar(e.x, e.y, "#e74c3c", false));
            hearts.forEach(h => drawHeart(h.x, h.y));
        }

        function animate() {
            if (isPaused || !gameActive) return;
            update();
            draw();
            requestAnimationFrame(animate);
        }

        animate();
    </script>
</body>
</html>
