<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Dr. Driving Fix</title>
    <style>
        body { margin: 0; overflow: hidden; background: #87ceeb; font-family: sans-serif; touch-action: none; }
        #game-wrap { position: relative; width: 100vw; height: 100vh; display: flex; flex-direction: column; }
        canvas { width: 100%; height: 65vh; background: #87ceeb; display: block; }
        #controls { height: 35vh; background: #1a1a1a; border-top: 5px solid #333; display: flex; justify-content: space-around; align-items: center; padding: 10px; }
        .pedal { width: 70px; height: 110px; background: #333; border-radius: 8px; border: 3px solid #555; color: white; display: flex; align-items: center; justify-content: center; font-size: 14px; font-weight: bold; }
        #steering-box { width: 140px; height: 140px; }
        #wheel-img { width: 100%; height: 100%; border: 12px solid #333; border-radius: 50%; background: #444; position: relative; transition: transform 0.1s; }
        #wheel-img::after { content: ""; position: absolute; top: 50%; left: 0; width: 100%; height: 10px; background: #222; transform: translateY(-50%); }
        #stats { position: absolute; top: 10px; width: 100%; display: flex; justify-content: space-between; padding: 0 20px; box-sizing: border-box; color: white; font-weight: bold; font-size: 20px; z-index: 100; }
    </style>
</head>
<body>

<div id="game-wrap">
    <div id="stats">
        <div><span id="speed">0</span> KM/H</div>
        <div style="color:#f1c40f">FUEL: <span id="fuel">100</span>%</div>
    </div>
    <canvas id="roadCanvas"></canvas>
    <div id="controls">
        <div class="pedal" id="brakeBtn" style="border-color:#e74c3c">BRAKE</div>
        <div id="steering-box"><div id="wheel-img"></div></div>
        <div class="pedal" id="gasBtn" style="border-color:#2ecc71">GAS</div>
    </div>
</div>

<script>
    const canvas = document.getElementById('roadCanvas');
    const ctx = canvas.getContext('2d');
    const wheel = document.getElementById('wheel-img');
    const speedEl = document.getElementById('speed');

    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight * 0.65;

    let carX = canvas.width / 2;
    let steer = 0;
    let speed = 0;
    let roadOffset = 0;
    let isGas = false;
    let isBrake = false;

    // Control Listeners
    const gasBtn = document.getElementById('gasBtn');
    const brakeBtn = document.getElementById('brakeBtn');

    gasBtn.onpointerdown = () => isGas = true;
    gasBtn.onpointerup = () => isGas = false;
    brakeBtn.onpointerdown = () => isBrake = true;
    brakeBtn.onpointerup = () => isBrake = false;

    // Steering logic (Simple Touch)
    document.getElementById('steering-box').onpointermove = (e) => {
        let rect = e.target.getBoundingClientRect();
        let x = e.clientX - (rect.left + rect.width / 2);
        steer = x / 1.5;
        if(steer > 45) steer = 45;
        if(steer < -45) steer = -45;
        wheel.style.transform = `rotate(${steer * 2}deg)`;
    };
    document.onpointerup = () => { steer = 0; wheel.style.transform = `rotate(0deg)`; isGas = false; isBrake = false; };

    // Buildings for City Look
    let buildings = [];
    for(let i=0; i<6; i++) {
        buildings.push({ x: i%2==0 ? 20 : canvas.width-70, y: i*150, h: 100+Math.random()*150, color: '#34495e' });
    }

    function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        // Sky & Ground
        ctx.fillStyle = "#87ceeb"; ctx.fillRect(0, 0, canvas.width, canvas.height/2);
        ctx.fillStyle = "#2ecc71"; ctx.fillRect(0, canvas.height/2, canvas.width, canvas.height/2);

        // Road
        ctx.fillStyle = "#444";
        ctx.beginPath();
        ctx.moveTo(canvas.width*0.4, canvas.height/2);
        ctx.lineTo(canvas.width*0.6, canvas.height/2);
        ctx.lineTo(canvas.width, canvas.height);
        ctx.lineTo(0, canvas.height);
        ctx.fill();

        // Animated Road Lines
        roadOffset += speed / 5;
        ctx.strokeStyle = "white"; ctx.setLineDash([20, 40]);
        ctx.lineDashOffset = -roadOffset;
        ctx.beginPath(); ctx.moveTo(canvas.width/2, canvas.height/2); ctx.lineTo(canvas.width/2, canvas.height); ctx.stroke();

        // Draw Buildings
        buildings.forEach(b => {
            ctx.fillStyle = b.color;
            ctx.fillRect(b.x, b.y, 50, b.h);
            b.y += speed / 4; // Move buildings with speed
            if(b.y > canvas.height) b.y = -200; 
        });

        // Player Car (Rear View)
        ctx.save();
        ctx.translate(carX, canvas.height - 100);
        ctx.rotate(steer * 0.005);
        ctx.fillStyle = "yellow"; ctx.fillRect(-35, -50, 70, 50); // Body
        ctx.fillStyle = "black"; ctx.fillRect(-35, -10, 70, 10); // Bumper
        ctx.fillStyle = "red"; ctx.fillRect(-30, -45, 15, 8); ctx.fillRect(15, -45, 15, 8); // Lights
        ctx.restore();

        // Physics
        if(isGas && speed < 140) speed += 0.8;
        else if(isBrake && speed > 0) speed -= 1.5;
        else if(speed > 0) speed -= 0.2; // Friction

        carX += (steer * (speed/150));
        speedEl.innerText = Math.floor(speed);

        requestAnimationFrame(draw);
    }
    draw();
</script>
</body>
</html>
