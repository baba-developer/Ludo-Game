<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Candy Crush Clone</title>
    <style>
        body { margin: 0; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; background: #f0f0f0; font-family: 'Arial', sans-serif; overflow: hidden; touch-action: none; }
        #header { margin-bottom: 10px; text-align: center; }
        .score-board { font-size: 24px; font-weight: bold; color: #ff3f81; }
        
        /* Game Board Grid */
        #grid { 
            display: grid; 
            grid-template-columns: repeat(8, 40px); 
            grid-template-rows: repeat(8, 40px); 
            gap: 2px; 
            background: #ccc; 
            padding: 5px; 
            border-radius: 10px; 
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }

        /* Candies Style */
        .candy { 
            width: 40px; 
            height: 40px; 
            border-radius: 5px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            font-size: 20px; 
            cursor: pointer;
            transition: transform 0.1s;
        }
        .candy:active { transform: scale(0.9); }
    </style>
</head>
<body>

    <div id="header">
        <div class="score-board">SCORE: <span id="score">0</span></div>
        <p style="font-size: 12px; color: #666;">Drag candies to swap</p>
    </div>

    <div id="grid"></div>

    <script>
        const grid = document.getElementById('grid');
        const scoreDisplay = document.getElementById('score');
        const width = 8;
        const candies = [];
        let score = 0;

        const candyColors = [
            '#FF5733', // Red
            '#33FF57', // Green
            '#3357FF', // Blue
            '#F1C40F', // Yellow
            '#9B59B6', // Purple
            '#E67E22'  // Orange
        ];

        // 1. Board Create Karna
        function createBoard() {
            for (let i = 0; i < width * width; i++) {
                const candy = document.createElement('div');
                candy.classList.add('candy');
                candy.setAttribute('draggable', true);
                candy.setAttribute('id', i);
                let randomColor = Math.floor(Math.random() * candyColors.length);
                candy.style.backgroundColor = candyColors[randomColor];
                grid.appendChild(candy);
                candies.push(candy);
            }
        }
        createBoard();

        // 2. Swapping Logic
        let colorBeingDragged, colorBeingReplaced;
        let idBeingDragged, idBeingReplaced;

        candies.forEach(candy => candy.addEventListener('touchstart', dragStart));
        candies.forEach(candy => candy.addEventListener('touchend', dragEnd));
        candies.forEach(candy => candy.addEventListener('touchmove', e => {
            let touch = e.touches[0];
            let target = document.elementFromPoint(touch.clientX, touch.clientY);
            if (target && target.classList.contains('candy')) {
                idBeingReplaced = parseInt(target.id);
                colorBeingReplaced = target.style.backgroundColor;
            }
        }));

        function dragStart() {
            colorBeingDragged = this.style.backgroundColor;
            idBeingDragged = parseInt(this.id);
        }

        function dragEnd() {
            let validMoves = [
                idBeingDragged - 1,
                idBeingDragged - width,
                idBeingDragged + 1,
                idBeingDragged + width
            ];

            let validMove = validMoves.includes(idBeingReplaced);

            if (idBeingReplaced && validMove) {
                candies[idBeingReplaced].style.backgroundColor = colorBeingDragged;
                candies[idBeingDragged].style.backgroundColor = colorBeingReplaced;
                checkMatches();
            }
        }

        // 3. Matching Logic (Row and Column)
        function checkMatches() {
            // Check for Row of Three
            for (let i = 0; i < 61; i++) {
                let rowOfThree = [i, i + 1, i + 2];
                let decidedColor = candies[i].style.backgroundColor;
                const isBlank = candies[i].style.backgroundColor === '';

                const notValid = [6, 7, 14, 15, 22, 23, 30, 31, 38, 39, 46, 47, 54, 55];
                if (notValid.includes(i)) continue;

                if (rowOfThree.every(index => candies[index].style.backgroundColor === decidedColor && !isBlank)) {
                    score += 3;
                    scoreDisplay.innerHTML = score;
                    rowOfThree.forEach(index => {
                        candies[index].style.backgroundColor = '';
                    });
                }
            }
            // Check for Column of Three
            for (let i = 0; i < 47; i++) {
                let columnOfThree = [i, i + width, i + width * 2];
                let decidedColor = candies[i].style.backgroundColor;
                const isBlank = candies[i].style.backgroundColor === '';

                if (columnOfThree.every(index => candies[index].style.backgroundColor === decidedColor && !isBlank)) {
                    score += 3;
                    scoreDisplay.innerHTML = score;
                    columnOfThree.forEach(index => {
                        candies[index].style.backgroundColor = '';
                    });
                }
            }
            fillEmpty();
        }

        // 4. Candies ko niche girana aur naye candies lana
        function fillEmpty() {
            for (let i = 0; i < 55; i++) {
                if (candies[i + width].style.backgroundColor === '') {
                    candies[i + width].style.backgroundColor = candies[i].style.backgroundColor;
                    candies[i].style.backgroundColor = '';
                }
                const firstRow = [0, 1, 2, 3, 4, 5, 6, 7];
                const isFirstRow = firstRow.includes(i);
                if (isFirstRow && candies[i].style.backgroundColor === '') {
                    let randomColor = Math.floor(Math.random() * candyColors.length);
                    candies[i].style.backgroundColor = candyColors[randomColor];
                }
            }
        }

        window.setInterval(function(){
            checkMatches();
        }, 100);

    </script>
</body>
</html>
