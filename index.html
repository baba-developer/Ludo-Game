<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Dr. Driving 3D Perspective</title>
    <style>
        body { margin: 0; overflow: hidden; background: #87ceeb; font-family: sans-serif; touch-action: none; }
        #game-wrap { position: relative; width: 100vw; height: 100vh; display: flex; flex-direction: column; }
        
        /* Game Screen */
        canvas { width: 100%; height: 65vh; background: #222; display: block; }

        /* Dashboard Area */
        #controls { 
            height: 35vh; background: #1a1a1a; border-top: 5px solid #333;
            display: flex; justify-content: space-around; align-items: center; padding: 10px;
        }

        .pedal { width: 60px; height: 100px; background: #333; border-radius: 5px; border: 2px solid #555; color: white; display: flex; align-items: center; justify-content: center; font-size: 10px; font-weight: bold; }
        #gas:active { background: #2ecc71; }
        #brake:active { background: #e74c3c; }

        #steering-box { width: 150px; height: 150px; position: relative; }
        #wheel-img { 
            width: 100%; height: 100%; border: 10px solid #444; border-radius: 50%;
            background: linear-gradient(45deg, #222, #444); position: relative;
            transition: transform 0.1s;
        }
        #wheel-img::before { content: ""; position: absolute; top: 50%; left: 0; width: 100%; height: 10px; background: #444; }

        #stats { position: absolute; top: 10px; width: 100%; display: flex; justify-content: space-between; padding: 0 20px; box-sizing: border-box; color: white; font-weight: bold; font-size: 20px; pointer-events: none; }
    </style>
</head>
<body>

<div id="game-wrap">
    <div id="stats">
        <div>KM/H: <span id="speed">0</span></div>
        <div>FUEL: <span id="fuel">100</span>%</div>
    </div>

    <canvas id="roadCanvas"></canvas>

    <div id="controls">
        <div class="pedal" id="brake">BRAKE</div>
        <div id="steering-box"><div id="wheel-img"></div></div>
        <div class="pedal" id="gas">GAS</div>
    </div>
</div>

<script>
    const canvas = document.getElementById('roadCanvas');
    const ctx = canvas.getContext('2d');
    const wheel = document.getElementById('wheel-img');
    const speedEl = document.getElementById('speed');

    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight * 0.65;

    let carX = canvas.width / 2;
    let steer = 0;
    let speed = 0;
    let fuel = 100;
    let roadOffset = 0;
    let enemies = [];

    // Touch Controls for Steering
    document.getElementById('steering-box').ontouchmove = (e) => {
        let touch = e.touches[0];
        let rect = e.target.getBoundingClientRect();
        let centerX = rect.left + rect.width / 2;
        steer = (touch.clientX - centerX) / 2;
        if(steer > 40) steer = 40;
        if(steer < -40) steer = -40;
        wheel.style.transform = `rotate(${steer * 3}deg)`;
    };
    document.ontouchend = () => { steer = 0; wheel.style.transform = `rotate(0deg)`; };

    // Gas/Brake logic
    let isGas = false;
    document.getElementById('gas').ontouchstart = () => isGas = true;
    document.getElementById('gas').ontouchend = () => isGas = false;

    function drawRoad() {
        // Sky
        ctx.fillStyle = "#87ceeb";
        ctx.fillRect(0, 0, canvas.width, canvas.height / 2);

        // Ground/Grass
        ctx.fillStyle = "#2ecc71";
        ctx.fillRect(0, canvas.height / 2, canvas.width, canvas.height / 2);

        // 3D Road Projection
        ctx.fillStyle = "#444";
        ctx.beginPath();
        ctx.moveTo(canvas.width * 0.45, canvas.height / 2); // Vanishing point
        ctx.lineTo(canvas.width * 0.55, canvas.height / 2);
        ctx.lineTo(canvas.width * 0.9, canvas.height);
        ctx.lineTo(canvas.width * 0.1, canvas.height);
        ctx.fill();

        // Road Lines (Animated)
        roadOffset += speed / 5;
        ctx.strokeStyle = "white";
        ctx.setLineDash([20, 30]);
        ctx.lineDashOffset = -roadOffset;
        ctx.beginPath();
        ctx.moveTo(canvas.width / 2, canvas.height / 2);
        ctx.lineTo(canvas.width / 2, canvas.height);
        ctx.stroke();
    }

    function drawPlayerCar() {
        let w = 80, h = 120;
        let x = carX - w/2;
        let y = canvas.height - 140;

        // Perspective Tilt
        ctx.save();
        ctx.translate(carX, y + h/2);
        ctx.rotate(steer * 0.01);
        
        // 3D Car Body (Rear View)
        ctx.fillStyle = "yellow";
        ctx.fillRect(-w/2, -h/2, w, h-40); // Top
        ctx.fillStyle = "gold";
        ctx.fillRect(-w/2, -h/2 + 30, w, 50); // Rear panel
        
        // Lights
        ctx.fillStyle = "red";
        ctx.fillRect(-w/2 + 5, -h/2 + 40, 15, 10);
        ctx.fillRect(w/2 - 20, -h/2 + 40, 15, 10);
        
        ctx.restore();
    }

    function update() {
        if(isGas && speed < 120) speed += 0.5;
        else if(speed > 0) speed -= 0.3;

        carX += (steer * (speed / 100));
        speedEl.innerText = Math.floor(speed);

        // Keep car on road
        if(carX < canvas.width * 0.2) carX = canvas.width * 0.2;
        if(carX > canvas.width * 0.8) carX = canvas.width * 0.8;
    }

    function gameLoop() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        drawRoad();
        drawPlayerCar();
        update();
        requestAnimationFrame(gameLoop);
    }

    gameLoop();
</script>
</body>
</html>
