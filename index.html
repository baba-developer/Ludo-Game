<!DOCTYPE html>
<html>
<head>
    <title>Pro Racing Game</title>
    <style>
        body { margin: 0; overflow: hidden; background: #222; font-family: 'Arial', sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; }
        #game-container { position: relative; border: 4px solid #555; box-shadow: 0 0 50px rgba(0,0,0,0.5); }
        canvas { background: #333; display: block; }
        
        #ui-layer { position: absolute; top: 0; left: 0; width: 100%; padding: 15px; box-sizing: border-box; color: white; pointer-events: none; }
        .stats { font-size: 20px; font-weight: bold; text-shadow: 2px 2px 4px black; }
        
        #controls { position: absolute; bottom: 20px; right: 20px; display: flex; gap: 10px; pointer-events: all; }
        button { padding: 10px 20px; font-size: 16px; cursor: pointer; border: none; border-radius: 5px; background: #ff4b2b; color: white; font-weight: bold; transition: 0.3s; }
        button:hover { background: #ff416c; transform: scale(1.1); }
        #pauseBtn { background: #f9d423; color: #333; }
    </style>
</head>
<body>

    <div id="game-container">
        <div id="ui-layer">
            <div class="stats">Score: <span id="scoreVal">0</span></div>
            <div class="stats">High Score: <span id="highScore">0</span></div>
        </div>
        
        <canvas id="gameCanvas"></canvas>

        <div id="controls">
            <button id="pauseBtn" onclick="togglePause()">PAUSE</button>
            <button onclick="resetGame()">RESTART</button>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const scoreElement = document.getElementById('scoreVal');
        const highscoreElement = document.getElementById('highScore');

        canvas.width = 400;
        canvas.height = 600;

        let score = 0;
        let highScore = localStorage.getItem('racingHighScore') || 0;
        highscoreElement.innerText = highScore;

        let gameActive = true;
        let isPaused = false;
        let car = { x: 175, y: 480, w: 45, h: 85, speed: 6 };
        let enemies = [];
        let roadOffset = 0;

        // Lane positions taaki rasta block na ho
        const lanes = [40, 130, 220, 310];

        let keys = {};
        window.addEventListener('keydown', e => keys[e.code] = true);
        window.addEventListener('keyup', e => keys[e.code] = false);

        function drawCar(x, y, color, isPlayer) {
            // Wheels
            ctx.fillStyle = "#000";
            ctx.fillRect(x-2, y+10, 5, 15); ctx.fillRect(x+42, y+10, 5, 15);
            ctx.fillRect(x-2, y+60, 5, 15); ctx.fillRect(x+42, y+60, 5, 15);
            // Body
            ctx.fillStyle = color;
            ctx.beginPath(); ctx.roundRect(x, y, 45, 85, 8); ctx.fill();
            // Windows
            ctx.fillStyle = "rgba(255,255,255,0.4)";
            if(isPlayer) ctx.fillRect(x+5, y+15, 35, 12);
            else ctx.fillRect(x+5, y+58, 35, 12);
        }

        function spawnEnemy() {
            // Logic: Ek saath saari lanes block nahi hongi
            if (Math.random() < 0.02 && enemies.length < 3) {
                let randomLane = lanes[Math.floor(Math.random() * lanes.length)];
                
                // Check if lane is already occupied near the top
                let isBusy = enemies.some(e => e.y < 150 && e.x === randomLane);
                
                if (!isBusy) {
                    enemies.push({ x: randomLane, y: -100, w: 45, h: 85, speed: 3 + Math.random() * 4 });
                }
            }
        }

        function togglePause() {
            isPaused = !isPaused;
            document.getElementById('pauseBtn').innerText = isPaused ? "RESUME" : "PAUSE";
            if(!isPaused) animate();
        }

        function resetGame() {
            score = 0;
            scoreElement.innerText = score;
            enemies = [];
            car.x = 175;
            gameActive = true;
            isPaused = false;
            document.getElementById('pauseBtn').innerText = "PAUSE";
        }

        function update() {
            if (!gameActive || isPaused) return;

            if (keys['ArrowLeft'] && car.x > 10) car.x -= car.speed;
            if (keys['ArrowRight'] && car.x < canvas.width - car.w - 10) car.x += car.speed;

            roadOffset = (roadOffset + 5) % 40;

            enemies.forEach((enemy, index) => {
                enemy.y += enemy.speed;

                // Collision
                if (car.x < enemy.x + enemy.w && car.x + car.w > enemy.x &&
                    car.y < enemy.y + enemy.h && car.y + car.h > enemy.y) {
                    gameActive = false;
                    if(score > highScore) {
                        highScore = score;
                        localStorage.setItem('racingHighScore', highScore);
                        highscoreElement.innerText = highScore;
                    }
                    alert("GAME OVER! Score: " + score);
                    resetGame();
                }

                if (enemy.y > canvas.height) {
                    enemies.splice(index, 1);
                    score++;
                    scoreElement.innerText = score;
                }
            });
            spawnEnemy();
        }

        function draw() {
            // Draw Road
            ctx.fillStyle = "#333";
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Road Lines
            ctx.strokeStyle = "#fff";
            ctx.setLineDash([20, 20]);
            ctx.lineDashOffset = -roadOffset;
            for(let i=1; i<4; i++) {
                ctx.beginPath();
                ctx.moveTo(i * 100, 0); ctx.lineTo(i * 100, canvas.height);
                ctx.stroke();
            }

            // Draw Players & Enemies
            drawCar(car.x, car.y, "#00d2ff", true);
            enemies.forEach(e => drawCar(e.x, e.y, "#ff4b2b", false));
        }

        function animate() {
            if (isPaused) return;
            update();
            draw();
            requestAnimationFrame(animate);
        }

        animate();
    </script>
</body>
</html>
